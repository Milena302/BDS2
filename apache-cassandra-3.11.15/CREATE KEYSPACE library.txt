CREATE KEYSPACE library
WITH replication = {'class':'SimpleStrategy', 'replication_factor' : 3};


CREATE TABLE auteur (
    id int,
    prenom text,
    nom text,
    pays text,
    genre text,
    date_naissance text,
    PRIMARY KEY (pays, id)
);

-- Find authors from the country 'United States' who were born on '10/7/1974', ordered by their ids.
SELECT * FROM auteur WHERE pays = 'United States' ORDER BY id ASC;


CREATE TABLE adherent (
    id int,
    prenom text,
    nom text,
    genre text,
    date_inscription text,
    email text,
    telephone text,
    adresse text,
    PRIMARY KEY ((genre), nom, prenom, id)
);

-- Select adherents with genre 'Female' ordered by nom and prenom
SELECT * FROM adherent WHERE genre = 'Female' ORDER BY nom ASC, prenom ASC;


CREATE TABLE editeur (
    id int,
    prenom text,
    nom text,
    genre text,
    date_naissance text,
    PRIMARY KEY ((genre), nom, prenom,id)
);

-- Select adherents with genre 'Female' ordered by nom and prenom
SELECT * FROM editeur WHERE genre = 'Male' ORDER BY nom ASC, prenom ASC;

--index:
SELECT * FROM editeur WHERE date_naissance = '2/15/1983';
SELECT * FROM editeur WHERE date_naissance = '2/15/1983' ALLOW FILTERING;
CREATE INDEX date_naissance_index ON editeur (date_naissance);
SELECT * FROM editeur WHERE date_naissance = '2/15/1983';

	

CREATE TABLE employe (
    id int,
    prenom text,
    nom text,
    genre text,
    age text,
    PRIMARY KEY ((genre),nom,id)
);

-- Select employes with genre 'Male' ordered by nom;
SELECT * FROM employe WHERE genre = 'Male' ORDER BY nom ASC;

-- Index sur age
CREATE INDEX age_index ON employe (age);

CREATE TABLE emprunt (
     id int,
     date_emprunt text,
     date_limite_retour text,
     date_retour text,
     id_adherent int,
     id_employe int,
     id_livre int,
     PRIMARY KEY ((id_adherent, id_employe), date_emprunt,id)
);

-- Find borrow records of the adherent with id 587 and the employee with id 80, ordered by the borrowing dates.
SELECT * FROM emprunt WHERE id_adherent = 587 AND id_employe = 80 ORDER BY date_emprunt ASC;


CREATE TABLE livre (
    id int,
    titre text,
    description text,
    pays text,
    categorie int,
    auteur int,
    editeur int,
    PRIMARY KEY ((categorie, pays), titre,id)
);

-- Find books in category 1 from the country 'France', ordered by their titles.
SELECT * FROM livre WHERE categorie = 1 AND pays = 'France' ORDER BY titre ASC;

SELECT COUNT(*) FROM livre WHERE categorie = 1 AND pays = 'France';

